
<html>

<head>
	<link rel="stylesheet" type="text/css" href="style.css" />
</head>

<body>
<header>
	<h1 class="title">mgiulio</h1>
	<p>A paragraph</p>
</header>

<section class="main">
	<h1>Tweets</h1>
	<p>A paragraph</p>
</section>

<section class="aux">
	<aside class="widget about">
		<h2 class="title">About Me</h2>
		<img class="avatar">
		<p class="desc">Blah blah. Blah blah. Blah blah. Blah blah. Blah blah. Blah blah. Blah blah. Blah blah. Blah blah. Blah blah. Blah blah. Blah blah.</p>
	</aside>
</section>

<footer>
</footer>

<script src="../../inline-editors.js"></script>
<script>
var aboutDescEditor = new InlineEditor({
	el: document.querySelector('.aux .about .desc'),
	processNewText: sendToServer,
	activityIndicator: {
		message: 'Saving about desc...'
	}
});

var pageTileEditor = new InlineEditor({
	el: document.querySelector('header .title'),
	processNewText: sendToServer,
	activityIndicator: {
		message: 'Saving header title...'
	}
});

function sendToServer(text, el) {
	var
		rnd = Math.random
		minTime = 1,
		maxTime = 5,
		successProb = 0.9
	;
	return new Promise(function(resolve, reject) {
		var json = {
			el: el,
			text: text
		};
		
		console.log(json);
		
		setTimeout(function() {
			if (rnd() <= successProb)
				resolve(text);
			else {
				console.log('failure');
				reject('Cannot save text');
			}
		}, minTime + rnd()*maxTime * 1000);
	});
	
}
</script>
</body>

</html>