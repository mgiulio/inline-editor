
<html>

<head>
	<link rel="stylesheet" type="text/css" href="style.css" />
</head>

<body>
<header>
	<h1 class="editable">mgiulio</h1>
	<p>A paragraph</p>
</header>

<section class="main">
	<h1>Tweets</h1>
	<p>A paragraph</p>
</section>

<section class="aux">
	<aside class="widget about">
		<h2 class="title editable">About Me</h2>
		<img class="avatar">
		<p class="desc editable">Blah blah. Blah blah. Blah blah. Blah blah. Blah blah. Blah blah. Blah blah. Blah blah. Blah blah. Blah blah. Blah blah. Blah blah.</p>
	</aside>
</section>

<footer>
</footer>

<script src="../../inline-editors.js"></script>
<script>
inlineEditor.install({
	selector: 'header .editable',
	processNewText: sendToServer,
	activityIndicator: {
		message: 'Saving header...'
	}
});

inlineEditor.install({
	selector: '.aux .editable',
	processNewText: sendToServer,
	activityIndicator: {
		message: 'Saving aux...'
	}
});

inlineEditor.install({
	selector: '.aux .editable',
	processNewText: sendToServer,
	activityIndicator: {
		message: 'Saving aux1...'
	}
})


function sendToServer(el, text) {
	var
		rnd = Math.random
		minTime = 1,
		maxTime = 5,
		successProb = 0.9
	;
	return new Promise(function(resolve, reject) {
		var json = {
			el: el,
			text: text
		};
		
		console.log(json);
		
		setTimeout(function() {
			if (rnd() <= successProb)
				resolve(text);
			else {
				console.log('failure');
				reject('Cannot save text');
			}
		}, minTime + rnd()*maxTime * 1000);
	});
	
}
</script>
</body>

</html>